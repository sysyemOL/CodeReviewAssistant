# ä»£ç å·®å¼‚å¯¹æ¯”é¡µé¢ä¸ºç©º - è°ƒè¯•æŒ‡å—

## ğŸ› é—®é¢˜æè¿°

ç”¨æˆ·ç‚¹å‡»"æŸ¥çœ‹ä»£ç å·®å¼‚"æŒ‰é’®åï¼Œå¯¹è¯æ¡†å¼¹å‡ºä½†å†…å®¹ä¸ºç©ºï¼Œæ²¡æœ‰æ˜¾ç¤ºä»£ç å¯¹æ¯”ã€‚

## ğŸ” è°ƒè¯•æ­¥éª¤

### ç¬¬1æ­¥ï¼šæ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·

1. åœ¨Chrome/Edgeä¸­æŒ‰ `F12` æˆ– `Ctrl + Shift + I`
2. åˆ‡æ¢åˆ° **Console** æ ‡ç­¾

### ç¬¬2æ­¥ï¼šé‡ç°é—®é¢˜å¹¶æŸ¥çœ‹æ—¥å¿—

1. ä¸Šä¼ ä¸€ä¸ªä»£ç æ–‡ä»¶ï¼ˆå¦‚test_sample.pyï¼‰
2. å‘é€æ¶ˆæ¯è§¦å‘ä»£ç å®¡æŸ¥
3. ç­‰å¾…AIè¿”å›å®¡æŸ¥ç»“æœ
4. ç‚¹å‡»"æŸ¥çœ‹ä»£ç å·®å¼‚"æŒ‰é’®
5. è§‚å¯Ÿæ§åˆ¶å°è¾“å‡º

### ç¬¬3æ­¥ï¼šå…³é”®æ—¥å¿—åˆ†æ

#### é¢„æœŸçš„æ­£å¸¸æ—¥å¿—åº”è¯¥æ˜¯ï¼š

```javascript
=== å¼€å§‹æŸ¥çœ‹ä»£ç å·®å¼‚ ===
å½“å‰æ–‡ä»¶: {filename: "test_sample.py", id: "xxx", ...}
å½“å‰æ–‡ä»¶ID: "xxx"
åŸå§‹ä»£ç é•¿åº¦: 500  // åº”è¯¥ > 0
åŸå§‹ä»£ç å‰100å­—ç¬¦: "def calculate_sum(numbers):..."

=== AIæ¶ˆæ¯å†…å®¹åˆ†æ ===
æ¶ˆæ¯å…¨æ–‡å‰1000å­—ç¬¦: "## ğŸ“Š ä»£ç å®¡æŸ¥æŠ¥å‘Š..."
æ˜¯å¦åŒ…å«"ç»“æ„åŒ–ä¿®æ”¹æŒ‡ä»¤": true
æ˜¯å¦åŒ…å«"ä¿®æ”¹"å…³é”®å­—: true

âœ… æ£€æµ‹åˆ°ç»“æ„åŒ–ä¿®æ”¹æŒ‡ä»¤æ ‡é¢˜ï¼Œä½¿ç”¨æ™ºèƒ½åº”ç”¨æ¨¡å¼
âœ… æ‰¾åˆ°ç»“æ„åŒ–ä¿®æ”¹æŒ‡ä»¤éƒ¨åˆ†ï¼Œé•¿åº¦: 1234

========== æ­£åœ¨è§£æç¬¬ 1 ä¸ªä¿®æ”¹æŒ‡ä»¤å— ==========
å—å†…å®¹: **ä¿®æ”¹1ï¼šæ·»åŠ æ¨¡å—æ–‡æ¡£å­—ç¬¦ä¸²**...
ğŸ“ è§£æç»“æœï¼š
  - æè¿°: æ·»åŠ æ¨¡å—æ–‡æ¡£å­—ç¬¦ä¸²
  - æ“ä½œç±»å‹: INSERT
  - ä»£ç å†…å®¹é•¿åº¦: 45  // åº”è¯¥ > 0
  - ä»£ç å†…å®¹å‰100å­—ç¬¦: "'''..."

âœ… è§£ææˆåŠŸï¼Œå·²æ·»åŠ åˆ°æŒ‡ä»¤åˆ—è¡¨

ä¿®æ”¹åä»£ç é•¿åº¦: 523  // åº”è¯¥ > 0
```

#### å¯èƒ½çš„é—®é¢˜æ—¥å¿—ï¼š

**é—®é¢˜1ï¼šåŸå§‹ä»£ç ä¸ºç©º**
```javascript
åŸå§‹ä»£ç é•¿åº¦: 0  // âŒ è¿™æ˜¯é—®é¢˜ï¼
åŸå§‹ä»£ç å‰100å­—ç¬¦: undefined

âŒ æ–‡ä»¶å†…å®¹ä¸ºç©ºï¼æ–‡ä»¶ID: xxx
fileContents: {}  // âŒ fileContentsä¸ºç©ºå¯¹è±¡
```

**é—®é¢˜2ï¼šæ²¡æœ‰æ‰¾åˆ°ä»£ç å»ºè®®**
```javascript
ä¿®æ”¹åä»£ç é•¿åº¦: 0  // âŒ è¿™æ˜¯é—®é¢˜ï¼
âš ï¸ æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„ä»£ç å»ºè®®
```

**é—®é¢˜3ï¼šMonaco Editoræ²¡æœ‰æŒ‚è½½**
```javascript
// å¦‚æœæ²¡æœ‰ä»»ä½•Monacoç›¸å…³çš„æ—¥å¿—ï¼Œå¯èƒ½æ˜¯ç¼–è¾‘å™¨æ²¡æœ‰æ­£ç¡®æŒ‚è½½
```

### ç¬¬4æ­¥ï¼šæ£€æŸ¥Vue DevToolsï¼ˆé«˜çº§ï¼‰

1. å®‰è£…Vue DevToolsæµè§ˆå™¨æ‰©å±•
2. æ‰“å¼€Vue DevTools
3. æ‰¾åˆ° `MessageItem` ç»„ä»¶
4. æ£€æŸ¥ä»¥ä¸‹çŠ¶æ€ï¼š

```javascript
// åœ¨Vue DevToolsä¸­æŸ¥çœ‹
showDiffDialog: true  // åº”è¯¥æ˜¯true
currentCodePair: {
  fileName: "test_sample.py",
  original: "def calculate_sum...",  // åº”è¯¥æœ‰å†…å®¹
  modified: "def calculate_sum...",  // åº”è¯¥æœ‰å†…å®¹
  language: "python"
}
```

### ç¬¬5æ­¥ï¼šæ£€æŸ¥æ–‡ä»¶å­˜å‚¨ï¼ˆå…³é”®ï¼ï¼‰

åœ¨Consoleä¸­æ‰§è¡Œï¼š

```javascript
// æ£€æŸ¥å½“å‰æ–‡ä»¶ä¿¡æ¯
$0.__vnode.ctx.$fileStore.currentFile
// åº”è¯¥è¾“å‡º: {filename: "test_sample.py", id: "xxx", ...}

// æ£€æŸ¥å½“å‰æ–‡ä»¶ID
$0.__vnode.ctx.$fileStore.currentFileId
// åº”è¯¥è¾“å‡º: "xxx"

// æ£€æŸ¥æ–‡ä»¶å†…å®¹å­˜å‚¨
$0.__vnode.ctx.$fileStore.fileContents
// åº”è¯¥è¾“å‡º: {"xxx": "def calculate_sum..."}

// æ£€æŸ¥å½“å‰æ–‡ä»¶å†…å®¹
$0.__vnode.ctx.$fileStore.currentFileContent
// åº”è¯¥è¾“å‡º: "def calculate_sum..."
```

å¦‚æœä»¥ä¸Šä»»ä½•ä¸€ä¸ªè¿”å› `null` æˆ– `undefined`ï¼Œè¯´æ˜æ–‡ä»¶å†…å®¹æ²¡æœ‰æ­£ç¡®å­˜å‚¨ã€‚

---

## ğŸ¯ å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

### é—®é¢˜1ï¼šåŸå§‹ä»£ç ä¸ºç©ºï¼ˆæœ€å¸¸è§ï¼‰

**ç°è±¡ï¼š**
```javascript
åŸå§‹ä»£ç é•¿åº¦: 0
æ–‡ä»¶å†…å®¹ä¸ºç©ºï¼æ–‡ä»¶ID: xxx
fileContents: {}
```

**åŸå› ï¼š** 
æ–‡ä»¶ä¸Šä¼ åï¼Œå†…å®¹æ²¡æœ‰è¢«æ­£ç¡®å­˜å‚¨åˆ° `fileStore.fileContents` ä¸­ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**

æ£€æŸ¥ `ReviewWorkspace.vue` ä¸­çš„æ–‡ä»¶ä¸Šä¼ é€»è¾‘ï¼š

```javascript
// åœ¨ handleSendMessage ä¸­
const uploadedFile = await fileAPI.uploadFile(formData, (progress) => {
  uploadProgress.value = progress
})

// â­ å…³é”®ï¼šå¿…é¡»è°ƒç”¨ setFileContent ä¿å­˜æ–‡ä»¶å†…å®¹
fileStore.setFileContent(uploadedFile.id, uploadedFile.content)
```

**å¦‚æœç¼ºå°‘è¿™ä¸€è¡Œï¼Œéœ€è¦æ·»åŠ ï¼š**

1. æ‰“å¼€ `vue3-front/vue-project/src/views/ReviewWorkspace.vue`
2. æ‰¾åˆ° `handleSendMessage` å‡½æ•°
3. åœ¨ `fileStore.addFile(uploadedFile)` ä¹‹åæ·»åŠ ï¼š
   ```javascript
   fileStore.setFileContent(uploadedFile.id, uploadedFile.content)
   ```

### é—®é¢˜2ï¼šæ²¡æœ‰æ‰¾åˆ°ä»£ç å»ºè®®

**ç°è±¡ï¼š**
```javascript
ä½¿ç”¨ä¼ ç»Ÿä»£ç å—è§£ææ–¹å¼
è§£æåˆ°çš„ä»£ç å—æ•°é‡: 0
âŒ æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„ä»£ç å»ºè®®
```

**åŸå› ï¼š**
AIè¿”å›çš„æ¶ˆæ¯ä¸­æ²¡æœ‰åŒ…å«ä»£ç å—æˆ–ç»“æ„åŒ–ä¿®æ”¹æŒ‡ä»¤ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**

1. æ£€æŸ¥AIè¿”å›çš„æ¶ˆæ¯å†…å®¹ï¼š
   ```javascript
   // åœ¨Consoleä¸­
   console.log(props.message.content)
   ```

2. ç¡®è®¤AIè¿”å›çš„æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼š
   - åº”è¯¥åŒ…å« `#### ğŸ”§ ç»“æ„åŒ–ä¿®æ”¹æŒ‡ä»¤` æ ‡é¢˜
   - æˆ–è€…åŒ…å« ````python` ä»£ç å—

3. å¦‚æœæ ¼å¼ä¸æ­£ç¡®ï¼Œå¯èƒ½æ˜¯åç«¯Promptéœ€è¦ä¼˜åŒ–ã€‚

### é—®é¢˜3ï¼šMonaco Editoræ²¡æœ‰æ¸²æŸ“

**ç°è±¡ï¼š**
- å¯¹è¯æ¡†å¼¹å‡º
- ä½†æ˜¯å®Œå…¨ç©ºç™½ï¼Œæ²¡æœ‰ä»»ä½•å†…å®¹
- æ§åˆ¶å°æ²¡æœ‰Monacoç›¸å…³æ—¥å¿—

**åŸå› ï¼š**
- `currentCodePair` ä¸º `null`
- æˆ–è€… `v-if` æ¡ä»¶ä¸æ»¡è¶³

**è§£å†³æ–¹æ¡ˆï¼š**

åœ¨Consoleä¸­æ£€æŸ¥ï¼š
```javascript
// æ£€æŸ¥currentCodePair
$0.__vnode.ctx.currentCodePair
// åº”è¯¥æ˜¯: {fileName: "...", original: "...", modified: "...", language: "..."}

// æ£€æŸ¥showDiffDialog
$0.__vnode.ctx.showDiffDialog
// åº”è¯¥æ˜¯: true
```

å¦‚æœ `currentCodePair` ä¸º `null`ï¼Œè¯´æ˜åœ¨ `handleShowDiff` ä¸­æ²¡æœ‰æ­£ç¡®è®¾ç½®ã€‚

### é—®é¢˜4ï¼šå¯¹è¯æ¡†å¤ªå°æˆ–ä½ç½®ä¸å¯¹

**ç°è±¡ï¼š**
- å¯¹è¯æ¡†æ˜¾ç¤ºäº†ï¼Œä½†æ˜¯çœ‹ä¸åˆ°å†…å®¹
- å¯¹è¯æ¡†ä½ç½®åœ¨å±å¹•å¤–

**è§£å†³æ–¹æ¡ˆï¼š**

æ£€æŸ¥å¯¹è¯æ¡†å°ºå¯¸ï¼š
```javascript
// åœ¨Consoleä¸­
document.querySelector('.diff-dialog-wrapper .el-dialog').style.width
document.querySelector('.diff-dialog-wrapper .el-dialog').style.height
```

åº”è¯¥æ˜¯åˆç†çš„å°ºå¯¸ï¼ˆå¦‚ `800px` Ã— `600px`ï¼‰ã€‚

---

## ğŸ”§ å¿«é€Ÿä¿®å¤è„šæœ¬

### è„šæœ¬1ï¼šæ£€æŸ¥æ–‡ä»¶å­˜å‚¨çŠ¶æ€

```javascript
// åœ¨æµè§ˆå™¨Consoleä¸­æ‰§è¡Œ
(function checkFileStore() {
  const fileStore = window.__VUE_DEVTOOLS_GLOBAL_HOOK__.apps[0]._container._vnode.component.appContext.config.globalProperties.$fileStore
  
  console.log('=== æ–‡ä»¶å­˜å‚¨çŠ¶æ€æ£€æŸ¥ ===')
  console.log('å½“å‰æ–‡ä»¶:', fileStore.currentFile)
  console.log('å½“å‰æ–‡ä»¶ID:', fileStore.currentFileId)
  console.log('æ–‡ä»¶å†…å®¹å­˜å‚¨:', fileStore.fileContents)
  console.log('å½“å‰æ–‡ä»¶å†…å®¹é•¿åº¦:', fileStore.currentFileContent?.length || 0)
  
  if (!fileStore.currentFile) {
    console.error('âŒ æ²¡æœ‰é€‰ä¸­çš„æ–‡ä»¶')
  } else if (!fileStore.currentFileContent) {
    console.error('âŒ æ–‡ä»¶å†…å®¹ä¸ºç©º')
    console.log('æ–‡ä»¶ID:', fileStore.currentFileId)
    console.log('fileContents:', fileStore.fileContents)
  } else {
    console.log('âœ… æ–‡ä»¶çŠ¶æ€æ­£å¸¸')
  }
})()
```

### è„šæœ¬2ï¼šæ‰‹åŠ¨è®¾ç½®æµ‹è¯•æ•°æ®ï¼ˆä¸´æ—¶æµ‹è¯•ï¼‰

```javascript
// åœ¨æµè§ˆå™¨Consoleä¸­æ‰§è¡Œ
(function setTestData() {
  const fileStore = window.__VUE_DEVTOOLS_GLOBAL_HOOK__.apps[0]._container._vnode.component.appContext.config.globalProperties.$fileStore
  
  // æ‰‹åŠ¨è®¾ç½®æ–‡ä»¶å†…å®¹ï¼ˆä»…ç”¨äºæµ‹è¯•ï¼‰
  const testContent = `def calculate_sum(numbers):
    total = 0
    for num in numbers:
        total += num
    return total

def main():
    numbers = [1, 2, 3, 4, 5]
    result = calculate_sum(numbers)
    print(f"æ€»å’Œä¸º: {result}")

if __name__ == "__main__":
    main()`
  
  fileStore.setFileContent(fileStore.currentFileId, testContent)
  console.log('âœ… å·²è®¾ç½®æµ‹è¯•æ•°æ®')
  console.log('æ–‡ä»¶å†…å®¹é•¿åº¦:', fileStore.currentFileContent.length)
  
  // ç°åœ¨å†æ¬¡ç‚¹å‡»"æŸ¥çœ‹ä»£ç å·®å¼‚"åº”è¯¥å¯ä»¥çœ‹åˆ°å†…å®¹äº†
})()
```

---

## ğŸ“Š å®Œæ•´è°ƒè¯•æµç¨‹

### æµç¨‹å›¾

```
ç‚¹å‡»"æŸ¥çœ‹ä»£ç å·®å¼‚"
    â†“
handleShowDiff()
    â†“
è·å–å½“å‰æ–‡ä»¶: fileStore.currentFile â”â”â”â”â”â”“
    â†“                                    â”ƒ å¦‚æœä¸ºnull
è·å–æ–‡ä»¶å†…å®¹: fileStore.currentFileContent   â”ƒ â†’ æ˜¾ç¤ºè­¦å‘Š
    â†“ å¦‚æœä¸ºç©º                           â”ƒ
    â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
    â†“ æœ‰å†…å®¹
è§£æAIæ¶ˆæ¯å†…å®¹
    â†“
å°è¯•ç»“æ„åŒ–ä¿®æ”¹æŒ‡ä»¤ â”â”â”â”â”â”“
    â†“ å¦‚æœå¤±è´¥           â”ƒ
    â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
    â†“ å¦‚æœæˆåŠŸ           â†“
åº”ç”¨ä¿®æ”¹æŒ‡ä»¤  â†â”â”â”â”â”â”â”â” å°è¯•ä¼ ç»Ÿä»£ç å—
    â†“
ç”ŸæˆmodifiedCode
    â†“ å¦‚æœä¸ºç©º
    â”—â”â”â”â”â”â”â”â”â”â†’ æ˜¾ç¤ºè­¦å‘Š"æ²¡æœ‰æ‰¾åˆ°ä»£ç å»ºè®®"
    â†“ æœ‰å†…å®¹
è®¾ç½®currentCodePair
    â†“
æ˜¾ç¤ºå¯¹è¯æ¡†: showDiffDialog = true
    â†“
nextTick â†’ ç­‰å¾…DOMæ›´æ–°
    â†“
setupDragEvents + applyDialogSize
    â†“
MonacoDiffEditor onMounted
    â†“
åˆ›å»ºMonaco Diff Editor
    â†“
æ˜¾ç¤ºä»£ç å¯¹æ¯” âœ…
```

---

## ğŸ¯ éªŒè¯ä¿®å¤

ä¿®å¤åï¼Œåº”è¯¥çœ‹åˆ°ï¼š

1. **Consoleæ—¥å¿—æ­£å¸¸ï¼š**
   ```javascript
   âœ… åŸå§‹ä»£ç é•¿åº¦: 500
   âœ… ä¿®æ”¹åä»£ç é•¿åº¦: 523
   âœ… æˆåŠŸè§£æ 5 ä¸ªä¿®æ”¹æŒ‡ä»¤
   ```

2. **å¯¹è¯æ¡†å†…å®¹æ­£å¸¸ï¼š**
   - å·¦ä¾§æ˜¾ç¤ºåŸå§‹ä»£ç ï¼ˆå¸¦è¡Œå·ï¼‰
   - å³ä¾§æ˜¾ç¤ºä¿®æ”¹åçš„ä»£ç ï¼ˆå¸¦è¡Œå·ï¼‰
   - å·®å¼‚éƒ¨åˆ†é«˜äº®æ˜¾ç¤º
   - å¯ä»¥æ‹–æ‹½å¯¹è¯æ¡†
   - å¯ä»¥è°ƒæ•´å¤§å°

3. **Vue DevToolsçŠ¶æ€æ­£å¸¸ï¼š**
   ```javascript
   showDiffDialog: true
   currentCodePair: {
     fileName: "test_sample.py",
     original: "def calculate_sum...",  // æœ‰å®Œæ•´å†…å®¹
     modified: "'''\\næ­¤æ¨¡å—...\\n'''\\n\\ndef calculate_sum...",  // æœ‰å®Œæ•´å†…å®¹
     language: "python"
   }
   ```

---

## ğŸ“ æŠ¥å‘Šé—®é¢˜

å¦‚æœä»¥ä¸Šæ­¥éª¤éƒ½æ— æ³•è§£å†³é—®é¢˜ï¼Œè¯·è®°å½•ä»¥ä¸‹ä¿¡æ¯ï¼š

1. **Consoleå®Œæ•´æ—¥å¿—**ï¼ˆä»ç‚¹å‡»æŒ‰é’®å¼€å§‹ï¼‰
2. **æ–‡ä»¶å­˜å‚¨çŠ¶æ€**ï¼ˆä½¿ç”¨æ£€æŸ¥è„šæœ¬ï¼‰
3. **AIè¿”å›çš„æ¶ˆæ¯å†…å®¹**ï¼ˆå‰500å­—ç¬¦ï¼‰
4. **Vue DevToolsä¸­çš„currentCodePairå€¼**
5. **æµè§ˆå™¨å’Œç‰ˆæœ¬**ï¼ˆå¦‚Chrome 120ï¼‰

---

**è°ƒè¯•æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¶é—´**: 2025å¹´11æœˆ10æ—¥

